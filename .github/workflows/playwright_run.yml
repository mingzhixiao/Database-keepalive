name: Playwright Auto Login Task

# 触发条件：可以手动触发，也可以定时触发
on:
  workflow_dispatch: # 允许在 GitHub 页面上手动点击运行
  schedule:
    - cron: '0 1 * * *' # 可选：每天凌晨 1 点自动执行 (UTC 时间)

jobs:
  run-task:
    runs-on: ubuntu-latest

    steps:
    - name: 检出代码
      uses: actions/checkout@v4

    - name: 设置 Python 环境
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: 安装依赖
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: 安装 Playwright 浏览器及其依赖
      run: |
        # 这一步非常关键，安装 Chromium 浏览器和系统级库
        playwright install chromium --with-deps

    - name: 执行登录截图脚本
      run: |
        python your_script.py
      # 如果你的脚本里有敏感信息，建议使用 Secret（见下文）

    - name: 上传截图结果
      uses: actions/upload-artifact@v4
      with:
        name: login-screenshots
        path: |
          target_page_result.png
          error_debug.png
        # 只有在文件存在时才上传
        if-no-files-found: warn
